(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{315:function(t,e,n){"use strict";n.r(e);var o=n(121),r=n(318),a=function(){var t=this.$createElement,e=this._self._c||t;return e("v-app",[e("v-container",{staticClass:"pa-4",attrs:{fluid:""}},[e("v-row",[e("v-col",{attrs:{cols:"12"}},[e("v-card",{staticClass:"mb-4",attrs:{flat:""}},[e("v-card-title",{staticClass:"text-h5"},[e("v-icon",{attrs:{left:"",large:"",color:"primary"}},[this._v("mdi-robot")]),this._v("\n            AI Assistant Query Tool\n          ")],1)],1)],1)],1),this._v(" "),e("v-row",[e("v-col",{attrs:{cols:"12"}},[e("assistant-query")],1)],1)],1)],1)};a._withStripped=!0;var s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("v-card",[n("v-card-title",[n("v-icon",{attrs:{left:"",color:"primary"}},[t._v("mdi-robot-outline")]),t._v("\n    Query AI Assistant\n  ")],1),t._v(" "),n("v-card-text",[n("v-row",[n("v-col",{attrs:{cols:"12",md:"6"}},[n("v-select",{attrs:{items:t.assistants,"item-text":"text","item-value":"value",label:"Assistant",outlined:"",dense:"","prepend-inner-icon":"mdi-robot",loading:t.loadingAssistants,disabled:t.loading||t.loadingAssistants,hint:"Select AI assistant to query","persistent-hint":""},model:{value:t.selectedAssistant,callback:function(e){t.selectedAssistant=e},expression:"selectedAssistant"}})],1),t._v(" "),n("v-col",{attrs:{cols:"12",md:"6"}},[n("div",{staticClass:"d-flex align-center",staticStyle:{height:"40px"}},[n("v-btn",{staticClass:"mr-2",attrs:{small:"",outlined:"",color:"primary",disabled:t.loading},on:{click:t.copyConversationId}},[n("v-icon",{attrs:{left:"",small:""}},[t._v("mdi-content-copy")]),t._v("\n            Copy ID\n          ")],1),t._v(" "),n("v-btn",{attrs:{small:"",outlined:"",color:"secondary",disabled:t.loading},on:{click:t.newConversation}},[n("v-icon",{attrs:{left:"",small:""}},[t._v("mdi-plus-circle")]),t._v("\n            New\n          ")],1)],1)])],1),t._v(" "),n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("v-textarea",{attrs:{label:"Prompt",outlined:"",rows:"4",placeholder:"Enter your prompt here... (e.g., 'create a product structure for a toy car')",disabled:t.loading,counter:""},model:{value:t.prompt,callback:function(e){t.prompt=e},expression:"prompt"}})],1)],1),t._v(" "),n("v-expansion-panels",{attrs:{flat:""}},[n("v-expansion-panel",[n("v-expansion-panel-header",[n("span",[n("v-icon",{attrs:{left:"",small:""}},[t._v("mdi-tune")]),t._v("\n            Advanced Options\n          ")],1)]),t._v(" "),n("v-expansion-panel-content",[n("v-row",[n("v-col",{attrs:{cols:"12",md:"6"}},[n("v-select",{attrs:{items:t.availableModels,label:"LLM Model",outlined:"",dense:"",disabled:t.loading},model:{value:t.model,callback:function(e){t.model=e},expression:"model"}})],1),t._v(" "),n("v-col",{attrs:{cols:"12",md:"6"}},[n("v-select",{attrs:{items:t.languages,label:"Prompt Language",outlined:"",dense:"",disabled:t.loading},model:{value:t.language,callback:function(e){t.language=e},expression:"language"}})],1)],1),t._v(" "),n("v-row",[n("v-col",{attrs:{cols:"12",md:"4"}},[n("v-switch",{attrs:{label:"Enable Streaming",disabled:t.loading,dense:""},model:{value:t.streamEnabled,callback:function(e){t.streamEnabled=e},expression:"streamEnabled"}})],1),t._v(" "),n("v-col",{attrs:{cols:"12",md:"4"}},[n("v-switch",{attrs:{label:"Mock Mode",disabled:t.loading,dense:"",hint:"Use mock data for testing","persistent-hint":""},model:{value:t.mockMode,callback:function(e){t.mockMode=e},expression:"mockMode"}})],1),t._v(" "),n("v-col",{attrs:{cols:"12",md:"4"}},[n("v-switch",{attrs:{label:"NoCode Companion",disabled:t.loading,dense:""},model:{value:t.isNoCodeCompanion,callback:function(e){t.isNoCodeCompanion=e},expression:"isNoCodeCompanion"}})],1)],1),t._v(" "),n("v-row",[n("v-col",{attrs:{cols:"12"}},[n("v-textarea",{attrs:{label:"Context (JSON)",outlined:"",rows:"3",placeholder:'{"message": {"selected_dimensions": {...}}}',disabled:t.loading,dense:""},model:{value:t.contextJson,callback:function(e){t.contextJson=e},expression:"contextJson"}})],1)],1)],1)],1)],1),t._v(" "),n("v-row",{staticClass:"mt-4"},[n("v-col",{staticClass:"d-flex gap-2",attrs:{cols:"12"}},[n("v-btn",{attrs:{color:"primary",loading:t.loading,disabled:!t.prompt||!t.selectedAssistant},on:{click:t.submitQuery}},[n("v-icon",{attrs:{left:""}},[t._v("mdi-send")]),t._v("\n          Submit Query\n        ")],1),t._v(" "),n("v-btn",{attrs:{outlined:"",disabled:t.loading},on:{click:t.clearForm}},[n("v-icon",{attrs:{left:""}},[t._v("mdi-close")]),t._v("\n          Clear\n        ")],1),t._v(" "),n("v-spacer"),t._v(" "),n("v-btn",{attrs:{text:"",small:"",disabled:!t.response},on:{click:t.copyResponse}},[n("v-icon",{attrs:{left:"",small:""}},[t._v("mdi-content-copy")]),t._v("\n          Copy Response\n        ")],1)],1)],1),t._v(" "),n("v-divider",{staticClass:"my-4"}),t._v(" "),t.loading?n("div",{staticClass:"text-center py-8"},[n("v-progress-circular",{attrs:{indeterminate:"",color:"primary",size:"48"}}),t._v(" "),n("p",{staticClass:"mt-4 text-subtitle-1"},[t._v("Processing your request...")])],1):t.error?n("div",{staticClass:"mt-4"},[n("v-alert",{attrs:{type:"error",outlined:""}},[n("div",{staticClass:"text-h6"},[t._v("Error")]),t._v(" "),n("div",[t._v(t._s(t.error))])])],1):t.response?n("div",{staticClass:"mt-4"},[n("v-card",{staticClass:"mb-4",attrs:{outlined:""}},[n("v-card-subtitle",{staticClass:"pb-0"},[n("v-icon",{attrs:{left:"",small:"",color:"info"}},[t._v("mdi-information")]),t._v("\n          Summary\n        ")],1),t._v(" "),n("v-card-text",[n("div",{staticClass:"text-body-1"},[t._v(t._s(t.response.summary))])])],1),t._v(" "),n("v-card",{attrs:{outlined:""}},[n("v-card-subtitle",{staticClass:"pb-0 d-flex align-center"},[n("v-icon",{attrs:{left:"",small:"",color:"success"}},[t._v("mdi-file-tree")]),t._v("\n          Structure\n          "),n("v-spacer"),t._v(" "),n("v-btn-toggle",{attrs:{dense:"",mandatory:""},model:{value:t.viewMode,callback:function(e){t.viewMode=e},expression:"viewMode"}},[n("v-btn",{attrs:{small:"",value:"tree"}},[n("v-icon",{attrs:{small:""}},[t._v("mdi-file-tree")]),t._v("\n              Tree\n            ")],1),t._v(" "),n("v-btn",{attrs:{small:"",value:"json"}},[n("v-icon",{attrs:{small:""}},[t._v("mdi-code-json")]),t._v("\n              JSON\n            ")],1)],1)],1),t._v(" "),n("v-card-text",["tree"===t.viewMode?n("div",{staticClass:"structure-tree"},[n("tree-node",{attrs:{node:t.response.structure,level:0}})],1):n("pre",{staticClass:"json-view"},[t._v(t._s(JSON.stringify(t.response.structure,null,2)))])])],1),t._v(" "),n("v-card",{staticClass:"mt-4",attrs:{outlined:""}},[n("v-card-subtitle",{staticClass:"pb-0"},[n("v-icon",{attrs:{left:"",small:""}},[t._v("mdi-chart-box-outline")]),t._v("\n          Response Metadata\n        ")],1),t._v(" "),n("v-card-text",[n("v-simple-table",{attrs:{dense:""},scopedSlots:t._u([{key:"default",fn:function(){return[n("tbody",[n("tr",[n("td",{staticClass:"font-weight-bold"},[t._v("Model")]),t._v(" "),n("td",[t._v(t._s(t.response.metadata.model||"N/A"))])]),t._v(" "),n("tr",[n("td",{staticClass:"font-weight-bold"},[t._v("Tokens (Total)")]),t._v(" "),n("td",[t._v(t._s(t.response.metadata.totalTokens||"N/A"))])]),t._v(" "),n("tr",[n("td",{staticClass:"font-weight-bold"},[t._v("Finish Reason")]),t._v(" "),n("td",[t._v(t._s(t.response.metadata.finishReason||"N/A"))])]),t._v(" "),n("tr",[n("td",{staticClass:"font-weight-bold"},[t._v("Timestamp")]),t._v(" "),n("td",[t._v(t._s(t.formatTimestamp(t.response.metadata.timestamp)))])])])]},proxy:!0}])})],1)],1)],1):n("div",{staticClass:"text-center py-8 grey--text"},[n("v-icon",{attrs:{size:"64",color:"grey lighten-1"}},[t._v("mdi-robot-outline")]),t._v(" "),n("p",{staticClass:"mt-4 text-subtitle-1"},[t._v("Submit a query to see results")])],1)],1),t._v(" "),n("v-snackbar",{attrs:{color:t.snackbar.color,timeout:3e3,top:"",right:""},scopedSlots:t._u([{key:"action",fn:function(e){var o=e.attrs;return[n("v-btn",t._b({attrs:{text:""},on:{click:function(e){t.snackbar.show=!1}}},"v-btn",o,!1),[t._v("\n        Close\n      ")])]}}]),model:{value:t.snackbar.show,callback:function(e){t.$set(t.snackbar,"show",e)},expression:"snackbar.show"}},[t._v("\n    "+t._s(t.snackbar.message)+"\n    ")])],1)};s._withStripped=!0;var i=n(451);function c(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);e&&(o=o.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,o)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?c(Object(n),!0).forEach((function(e){u(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function u(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=d(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var o=n.call(t,e||"default");if("object"!=d(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==d(e)?e:e+""}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d(t){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,e,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function a(n,o,r,a){var c=o&&o.prototype instanceof i?o:i,l=Object.create(c.prototype);return v(l,"_invoke",function(n,o,r){var a,i,c,l=0,u=r||[],d=!1,p={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(e,n){return a=e,i=0,c=t,p.n=n,s}};function v(n,o){for(i=n,c=o,e=0;!d&&l&&!r&&e<u.length;e++){var r,a=u[e],v=p.p,f=a[2];n>3?(r=f===o)&&(c=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=t):a[0]<=v&&((r=n<2&&v<a[1])?(i=0,p.v=o,p.n=a[1]):v<f&&(r=n<3||a[0]>o||o>f)&&(a[4]=n,a[5]=o,p.n=f,i=0))}if(r||n>1)return s;throw d=!0,o}return function(r,u,f){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&v(u,f),i=u,c=f;(e=i<2?t:c)||!d;){a||(i?i<3?(i>1&&(p.n=-1),v(i,c)):p.n=c:p.v=c);try{if(l=2,a){if(i||(r="next"),e=a[r]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,i<2&&(i=0)}else 1===i&&(e=a.return)&&e.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),i=1);a=t}else if((e=(d=p.n<0)?c:n.call(o,p))!==s)break}catch(e){a=t,i=1,c=e}finally{l=1}}return{value:e,done:d}}}(n,r,a),!0),l}var s={};function i(){}function c(){}function l(){}e=Object.getPrototypeOf;var u=[][o]?e(e([][o]())):(v(e={},o,(function(){return this})),e),d=l.prototype=i.prototype=Object.create(u);function f(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,v(t,r,"GeneratorFunction")),t.prototype=Object.create(d),t}return c.prototype=l,v(d,"constructor",l),v(l,"constructor",c),c.displayName="GeneratorFunction",v(l,r,"GeneratorFunction"),v(d),v(d,r,"Generator"),v(d,o,(function(){return this})),v(d,"toString",(function(){return"[object Generator]"})),(p=function(){return{w:a,m:f}})()}function v(t,e,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(t){r=0}(v=function(t,e,n,o){function a(e,n){v(t,e,(function(t){return this._invoke(e,n,t)}))}e?r?r(t,e,{value:n,enumerable:!o,configurable:!o,writable:!o}):t[e]=n:(a("next",0),a("throw",1),a("return",2))})(t,e,n,o)}function f(t,e,n,o,r,a,s){try{var i=t[a](s),c=i.value}catch(t){return void n(t)}i.done?e(c):Promise.resolve(c).then(o,r)}function m(t){return function(){var e=this,n=arguments;return new Promise((function(o,r){var a=t.apply(e,n);function s(t){f(a,o,r,s,i,"next",t)}function i(t){f(a,o,r,s,i,"throw",t)}s(void 0)}))}}var b=!1;function h(){return y.apply(this,arguments)}function y(){return(y=m(p().m((function t(){var e;return p().w((function(t){for(;;)switch(t.p=t.n){case 0:if(!b){t.n=1;break}return console.log("[ApiService] Already initialized"),t.a(2);case 1:if(t.p=1,"undefined"==typeof window||!window.widget||!window.widget.uwaUrl){t.n=3;break}return console.log("[ApiService] Initializing Platform Connectors..."),t.n=2,Object(i.b)({securityContexts:[]});case 2:b=!0,console.log("[ApiService] Platform Connectors initialized successfully");case 3:t.n=5;break;case 4:t.p=4,e=t.v,console.warn("[ApiService] Failed to initialize Platform Connectors:",e),b=!1;case 5:return t.a(2)}}),t,null,[[1,4]])})))).apply(this,arguments)}function g(){try{return!("undefined"==typeof window||!window.widget)&&("function"==typeof i.a&&(!!window.widget.uwaUrl&&(b?(console.log("[ApiService] Running in trusted mode (3DDashboard)"),!0):(console.log("[ApiService] Platform Connectors not yet initialized"),!1))))}catch(t){return console.log("[ApiService] Not in trusted mode:",t.message),!1}}function w(t){return _.apply(this,arguments)}function _(){return(_=m(p().m((function t(e){var n,o,r,a,s,c,l=arguments;return p().w((function(t){for(;;)switch(t.p=t.n){case 0:if(n=l.length>1&&void 0!==l[1]?l[1]:{},o=l.length>2&&void 0!==l[2]?l[2]:null,r=l.length>3&&void 0!==l[3]?l[3]:null,a=g(),console.log("[ApiService] callWithFallback - isTrusted: ".concat(a,", backendUrl: ").concat(o,", proxyPath: ").concat(r)),!a){t.n=6;break}return t.p=1,console.log("[ApiService] Direct call to: ".concat(e)),t.n=2,Object(i.a)(e,{method:n.method||"GET",headers:n.headers||{},body:n.body,timeout:n.timeout||3e4});case 2:return s=t.v,console.log("[ApiService] Direct call succeeded"),t.a(2,s);case 3:if(t.p=3,c=t.v,console.warn("[ApiService] Direct call failed:",c),console.warn("[ApiService] Error details - Type: ".concat(d(c),", Message: ").concat((null==c?void 0:c.message)||"no message")),c.backendresponse&&console.warn("[ApiService] Backend response:",c.backendresponse),c.response_hdrs&&console.warn("[ApiService] Response headers:",c.response_hdrs),!o||!r){t.n=5;break}return console.log("[ApiService] Falling back to backend proxy"),t.n=4,x(o,r,n);case 4:return t.a(2,t.v);case 5:throw c;case 6:if(o&&r){t.n=7;break}throw new Error("Backend proxy not configured for standalone mode. Please start the backend server.");case 7:return console.log("[ApiService] Using backend proxy: ".concat(o).concat(r)),t.n=8,x(o,r,n);case 8:return t.a(2,t.v)}}),t,null,[[1,3]])})))).apply(this,arguments)}function x(t,e){return k.apply(this,arguments)}function k(){return(k=m(p().m((function t(e,n){var o,r,a,s,i,c,u,d=arguments;return p().w((function(t){for(;;)switch(t.p=t.n){case 0:return o=d.length>2&&void 0!==d[2]?d[2]:{},r="".concat(e).concat(n),a=new AbortController,s=setTimeout((function(){return a.abort()}),o.timeout||3e4),t.p=1,t.n=2,fetch(r,{method:o.method||"GET",headers:l({"Content-Type":"application/json"},o.headers),body:o.body?JSON.stringify(o.body):void 0,signal:a.signal});case 2:if(i=t.v,clearTimeout(s),i.ok){t.n=4;break}return t.n=3,i.text();case 3:throw c=t.v,new Error("HTTP ".concat(i.status,": ").concat(c));case 4:return t.n=5,i.json();case 5:return t.a(2,t.v);case 6:if(t.p=6,u=t.v,clearTimeout(s),"AbortError"!==u.name){t.n=7;break}throw new Error("Request timeout");case 7:throw u;case 8:return t.a(2)}}),t,null,[[1,6]])})))).apply(this,arguments)}var A=function(t,e){var n=arguments;return m(p().m((function o(){var r,a,s,i,c,l;return p().w((function(o){for(;;)switch(o.p=o.n){case 0:return r=n.length>2&&void 0!==n[2]?n[2]:"",console.log("[ApiService] getAssistants called with aiaiUrl: ".concat(t,", backendUrl: ").concat(e)),a="".concat(t,"/api/v1/assistants"),s={method:"GET"},i="/api/aiai/assistants?aiai_url=".concat(encodeURIComponent(t)).concat(r?"&assistant_namespace=".concat(r):""),o.p=1,o.n=2,w(a,s,e,i);case 2:return c=o.v,console.log("[ApiService] getAssistants succeeded"),o.a(2,c);case 3:throw o.p=3,l=o.v,console.error("[ApiService] getAssistants failed:",l),l;case 4:return o.a(2)}}),o,null,[[1,3]])})))()},C=function(t,e,n,o){var r=arguments;return m(p().m((function a(){var s,i,c,l;return p().w((function(a){for(;;)switch(a.n){case 0:return s=r.length>4&&void 0!==r[4]?r[4]:"",i="".concat(t,"/api/v1/assistants/").concat(n,"/submit"),c={method:"POST",headers:{"Content-Type":"application/json"},body:o,timeout:6e4},l="/api/aiai/assistants/".concat(n,"/submit?aiai_url=").concat(encodeURIComponent(t)).concat(s?"&assistant_namespace=".concat(s):""),a.n=1,w(i,c,e,l);case 1:return a.a(2,a.v)}}),a)})))()};function S(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,e,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function a(n,o,r,a){var c=o&&o.prototype instanceof i?o:i,l=Object.create(c.prototype);return O(l,"_invoke",function(n,o,r){var a,i,c,l=0,u=r||[],d=!1,p={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(e,n){return a=e,i=0,c=t,p.n=n,s}};function v(n,o){for(i=n,c=o,e=0;!d&&l&&!r&&e<u.length;e++){var r,a=u[e],v=p.p,f=a[2];n>3?(r=f===o)&&(c=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=t):a[0]<=v&&((r=n<2&&v<a[1])?(i=0,p.v=o,p.n=a[1]):v<f&&(r=n<3||a[0]>o||o>f)&&(a[4]=n,a[5]=o,p.n=f,i=0))}if(r||n>1)return s;throw d=!0,o}return function(r,u,f){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&v(u,f),i=u,c=f;(e=i<2?t:c)||!d;){a||(i?i<3?(i>1&&(p.n=-1),v(i,c)):p.n=c:p.v=c);try{if(l=2,a){if(i||(r="next"),e=a[r]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,i<2&&(i=0)}else 1===i&&(e=a.return)&&e.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),i=1);a=t}else if((e=(d=p.n<0)?c:n.call(o,p))!==s)break}catch(e){a=t,i=1,c=e}finally{l=1}}return{value:e,done:d}}}(n,r,a),!0),l}var s={};function i(){}function c(){}function l(){}e=Object.getPrototypeOf;var u=[][o]?e(e([][o]())):(O(e={},o,(function(){return this})),e),d=l.prototype=i.prototype=Object.create(u);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,O(t,r,"GeneratorFunction")),t.prototype=Object.create(d),t}return c.prototype=l,O(d,"constructor",l),O(l,"constructor",c),c.displayName="GeneratorFunction",O(l,r,"GeneratorFunction"),O(d),O(d,r,"Generator"),O(d,o,(function(){return this})),O(d,"toString",(function(){return"[object Generator]"})),(S=function(){return{w:a,m:p}})()}function O(t,e,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(t){r=0}(O=function(t,e,n,o){function a(e,n){O(t,e,(function(t){return this._invoke(e,n,t)}))}e?r?r(t,e,{value:n,enumerable:!o,configurable:!o,writable:!o}):t[e]=n:(a("next",0),a("throw",1),a("return",2))})(t,e,n,o)}function j(t,e,n,o,r,a,s){try{var i=t[a](s),c=i.value}catch(t){return void n(t)}i.done?e(c):Promise.resolve(c).then(o,r)}function P(t){return function(){var e=this,n=arguments;return new Promise((function(o,r){var a=t.apply(e,n);function s(t){j(a,o,r,s,i,"next",t)}function i(t){j(a,o,r,s,i,"throw",t)}s(void 0)}))}}var T={name:"AssistantQuery",components:{TreeNode:{name:"TreeNode",props:{node:{type:Object,required:!0},level:{type:Number,default:0}},template:'\n    <div :style="{ marginLeft: (level * 20) + \'px\' }" class="tree-node">\n      <div class="node-header">\n        <span :class="[\'node-icon\', hasChildren ? \'folder\' : \'file\']">\n          {{ hasChildren ? \'üìÅ\' : \'üìÑ\' }}\n        </span>\n        <span class="node-name">{{ node.name }}</span>\n        <span v-if="node.quantity" class="node-quantity">\n          Qty: {{ node.quantity }}\n        </span>\n      </div>\n      <div v-if="hasChildren" class="node-children">\n        <tree-node\n          v-for="(child, index) in node.components"\n          :key="index"\n          :node="child"\n          :level="level + 1"\n        />\n      </div>\n    </div>\n  ',computed:{hasChildren:function(){return this.node.components&&this.node.components.length>0}}}},data:function(){return{selectedAssistant:"",prompt:"",conversationId:"",model:"mistralai/mistral-small-2506",language:"en",streamEnabled:!1,mockMode:!1,isNoCodeCompanion:!1,contextJson:"",loading:!1,loadingAssistants:!1,error:null,response:null,viewMode:"tree",snackbar:{show:!1,message:"",color:"success"},aiaiUrl:"https://devopsyivwvbl820289-euw1-devprol50-aiai.3dx-staging.3ds.com",backendUrl:"http://localhost:8080",assistants:[],availableModels:["mistralai/mistral-small-2506","mistralai/mistral-large-2411","anthropic/claude-3-5-sonnet-20241022","openai/gpt-4o-2024-11-20"],languages:[{text:"English",value:"en"},{text:"French",value:"fr"},{text:"German",value:"de"},{text:"Spanish",value:"es"}]}},mounted:function(){if(console.log("[AssistantQuery] Component mounted"),this.generateConversationId(),"undefined"!=typeof widget&&widget.getValue)try{this.aiaiUrl=widget.getValue("aiaiUrl")||this.aiaiUrl,this.backendUrl=widget.getValue("backendUrl")||this.backendUrl,console.log("[AssistantQuery] Loaded aiaiUrl from preferences:",this.aiaiUrl),console.log("[AssistantQuery] Loaded backendUrl from preferences:",this.backendUrl)}catch(t){console.warn("[AssistantQuery] Could not load widget preferences:",t)}this.fetchAssistants()},methods:{fetchAssistants:function(){var t=this;return P(S().m((function e(){var n,o,r;return S().w((function(e){for(;;)switch(e.p=e.n){case 0:return t.loadingAssistants=!0,e.p=1,console.log("[AssistantQuery] Fetching assistants from:",t.aiaiUrl),e.n=2,A(t.aiaiUrl,t.backendUrl);case 2:n=e.v,console.log("[AssistantQuery] Raw assistant list:",n),console.log("[AssistantQuery] First assistant:",n[0]),console.log("[AssistantQuery] First assistant keys:",Object.keys(n[0]||{})),t.assistants=n.map((function(t){return{text:t.assistant__name||t.assistant__id,value:t.assistant__name||t.assistant__id}})),t.assistants.length>0&&(o=t.assistants.find((function(t){return"asmstruct"===t.value})),t.selectedAssistant=o?o.value:t.assistants[0].value),console.log("[AssistantQuery] Loaded assistants:",t.assistants),e.n=4;break;case 3:e.p=3,r=e.v,console.error("[AssistantQuery] Failed to load assistants:",r),t.assistants=[{text:"Assembly Structure (asmstruct)",value:"asmstruct"}],t.selectedAssistant="asmstruct";case 4:return e.p=4,t.loadingAssistants=!1,e.f(4);case 5:return e.a(2)}}),e,null,[[1,3,4,5]])})))()},generateConversationId:function(){this.conversationId="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)})),console.log("[AssistantQuery] Generated conversation ID:",this.conversationId)},copyConversationId:function(){var t=this;return P(S().m((function e(){var n;return S().w((function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,e.n=1,navigator.clipboard.writeText(t.conversationId);case 1:console.log("[AssistantQuery] Copied conversation ID to clipboard"),t.snackbar={show:!0,message:"Conversation ID copied: ".concat(t.conversationId.substring(0,8),"..."),color:"success"},e.n=3;break;case 2:e.p=2,n=e.v,console.error("[AssistantQuery] Failed to copy to clipboard:",n),t.snackbar={show:!0,message:"Failed to copy conversation ID",color:"error"};case 3:return e.a(2)}}),e,null,[[0,2]])})))()},newConversation:function(){console.log("[AssistantQuery] Starting new conversation"),this.generateConversationId(),this.response=null,this.error=null,this.snackbar={show:!0,message:"New conversation started",color:"info"}},submitQuery:function(){var t=this;return P(S().m((function e(){var n,o,r,a;return S().w((function(e){for(;;)switch(e.p=e.n){case 0:if(console.log("[AssistantQuery] Submitting query to:",t.selectedAssistant),t.loading=!0,t.error=null,t.response=null,e.p=1,!t.mockMode){e.n=3;break}return console.log("[AssistantQuery] Using mock mode"),e.n=2,new Promise((function(t){return setTimeout(t,1500)}));case 2:return t.response=t.parseMockResponse(),e.a(2);case 3:if(n={prompt:t.prompt,"llm.stream":t.streamEnabled,"llm.model":t.model,prompt_language:t.language,mock:t.mockMode},t.conversationId&&(n.conversation_id=t.conversationId),!t.contextJson){e.n=6;break}e.p=4,n.context=JSON.parse(t.contextJson),e.n=6;break;case 5:throw e.p=5,r=e.v,new Error("Invalid context JSON: ".concat(r.message));case 6:return console.log("[AssistantQuery] Request body:",n),e.n=7,C(t.aiaiUrl,t.backendUrl,t.selectedAssistant,n,"");case 7:o=e.v,console.log("[AssistantQuery] API response:",o),t.response=t.parseResponse(o),console.log("[AssistantQuery] Parsed response:",t.response),e.n=9;break;case 8:e.p=8,a=e.v,console.error("[AssistantQuery] Error submitting query:",a),t.error=a.message||"Failed to submit query";case 9:return e.p=9,t.loading=!1,e.f(9);case 10:return e.a(2)}}),e,null,[[4,5],[1,8,9,10]])})))()},parseResponse:function(t){try{var e,n,o,r,a,s,i,c,l,u,d,p=null===(e=t.llm)||void 0===e||null===(n=e.choices)||void 0===n||null===(o=n[0])||void 0===o||null===(r=o.message)||void 0===r?void 0:r.content;if(!p)throw new Error("No content in API response");var v=p.indexOf("{");if(-1===v)throw new Error("No JSON found in response");var f=p.substring(v),m=JSON.parse(f);return{summary:m.summary||"No summary provided",structure:m.structure||{},metadata:{model:(null===(a=t.llm)||void 0===a?void 0:a.model)||"N/A",totalTokens:(null===(s=t.llm)||void 0===s||null===(i=s.usage)||void 0===i?void 0:i.total_tokens)||0,finishReason:(null===(c=t.llm)||void 0===c||null===(l=c.choices)||void 0===l||null===(u=l[0])||void 0===u?void 0:u.finish_reason)||"N/A",timestamp:(null===(d=t.llm)||void 0===d?void 0:d.created)||Math.floor(Date.now()/1e3)}}}catch(t){throw console.error("[AssistantQuery] Failed to parse response:",t),new Error("Failed to parse response: ".concat(t.message))}},parseMockResponse:function(){var t={llm:{id:"2659f08b-3e8c-42c3-b21f-dae95a33264f",object:"chat.completion",created:Math.floor(Date.now()/1e3),model:this.model,choices:[{message:{content:'[asmstruct] {\n  "summary": "Here is the product structure for a toy car",\n  "structure": {\n    "name": "Toy Car",\n    "components": [\n      {\n        "name": "chassis",\n        "quantity": 1,\n        "components": [\n          {\n            "name": "body",\n            "quantity": 1\n          },\n          {\n            "name": "wheels",\n            "quantity": 4\n          }\n        ]\n      },\n      {\n        "name": "engine",\n        "quantity": 1\n      },\n      {\n        "name": "battery",\n        "quantity": 1\n      },\n      {\n        "name": "remote control",\n        "quantity": 1\n      }\n    ]\n  }\n}',role:"assistant"},index:0,logprobs:-1,finish_reason:"stop"}],usage:{prompt_tokens:120,completion_tokens:85,total_tokens:205}}},e=t.llm.choices[0].message.content,n=e.indexOf("{"),o=e.substring(n),r=JSON.parse(o);return{summary:r.summary,structure:r.structure,metadata:{model:t.llm.model,totalTokens:t.llm.usage.total_tokens,finishReason:t.llm.choices[0].finish_reason,timestamp:t.llm.created}}},clearForm:function(){this.prompt="",this.conversationId="",this.contextJson="",this.error=null,this.response=null},copyResponse:function(){if(this.response){var t=JSON.stringify(this.response.structure,null,2);navigator.clipboard.writeText(t).then((function(){console.log("[AssistantQuery] Response copied to clipboard")}))}},formatTimestamp:function(t){return t?new Date(1e3*t).toLocaleString():"N/A"}}},E=n(339),N=n.n(E),I=n(368),V=n.n(I),Q={insert:"head",singleton:!1},M=(N()(V.a,Q),V.a.locals,n(347)),U=n(348),F=n.n(U),D=n(479),G=n(353),R=n(480),q=n(357),J=n(329),z=n(465),L=n(358),H=n(466),B=n(467),$=n(468),W=n(469),K=n(355),X=n(343),Y=n(470),Z=n(476),tt=n(471),et=n(472),nt=n(473),ot=n(477),rt=n(474),at=Object(M.a)(T,s,[],!1,null,"7db409ba",null);F()(at,{VAlert:D.a,VBtn:G.a,VBtnToggle:R.a,VCard:q.a,VCardSubtitle:J.a,VCardText:J.b,VCardTitle:J.c,VCol:z.a,VDivider:L.a,VExpansionPanel:H.a,VExpansionPanelContent:B.a,VExpansionPanelHeader:$.a,VExpansionPanels:W.a,VIcon:K.a,VProgressCircular:X.a,VRow:Y.a,VSelect:Z.a,VSimpleTable:tt.a,VSnackbar:et.a,VSpacer:nt.a,VSwitch:ot.a,VTextarea:rt.a}),at.options.__file="src/components/AssistantQuery.vue";var st={name:"HealthDashboard",components:{AssistantQuery:at.exports}},it=n(439),ct=n.n(it),lt={insert:"head",singleton:!1},ut=(N()(ct.a,lt),ct.a.locals,n(475)),dt=n(478),pt=Object(M.a)(st,a,[],!1,null,"4ae0ad98",null);F()(pt,{VApp:ut.a,VCard:q.a,VCardTitle:J.c,VCol:z.a,VContainer:dt.a,VIcon:K.a,VRow:Y.a}),pt.options.__file="src/components/HealthDashboard.vue";var vt=pt.exports,ft=n(452);n(442);r.a.use(ft.a);var mt=new ft.a({icons:{iconfont:"mdi"}}),bt=n(450);r.a.use(bt.a);var ht=new bt.a.Store({state:{},mutations:{},actions:{},getters:{}});function yt(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */var t,e,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function a(n,o,r,a){var c=o&&o.prototype instanceof i?o:i,l=Object.create(c.prototype);return gt(l,"_invoke",function(n,o,r){var a,i,c,l=0,u=r||[],d=!1,p={p:0,n:0,v:t,a:v,f:v.bind(t,4),d:function(e,n){return a=e,i=0,c=t,p.n=n,s}};function v(n,o){for(i=n,c=o,e=0;!d&&l&&!r&&e<u.length;e++){var r,a=u[e],v=p.p,f=a[2];n>3?(r=f===o)&&(c=a[(i=a[4])?5:(i=3,3)],a[4]=a[5]=t):a[0]<=v&&((r=n<2&&v<a[1])?(i=0,p.v=o,p.n=a[1]):v<f&&(r=n<3||a[0]>o||o>f)&&(a[4]=n,a[5]=o,p.n=f,i=0))}if(r||n>1)return s;throw d=!0,o}return function(r,u,f){if(l>1)throw TypeError("Generator is already running");for(d&&1===u&&v(u,f),i=u,c=f;(e=i<2?t:c)||!d;){a||(i?i<3?(i>1&&(p.n=-1),v(i,c)):p.n=c:p.v=c);try{if(l=2,a){if(i||(r="next"),e=a[r]){if(!(e=e.call(a,c)))throw TypeError("iterator result is not an object");if(!e.done)return e;c=e.value,i<2&&(i=0)}else 1===i&&(e=a.return)&&e.call(a),i<2&&(c=TypeError("The iterator does not provide a '"+r+"' method"),i=1);a=t}else if((e=(d=p.n<0)?c:n.call(o,p))!==s)break}catch(e){a=t,i=1,c=e}finally{l=1}}return{value:e,done:d}}}(n,r,a),!0),l}var s={};function i(){}function c(){}function l(){}e=Object.getPrototypeOf;var u=[][o]?e(e([][o]())):(gt(e={},o,(function(){return this})),e),d=l.prototype=i.prototype=Object.create(u);function p(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,l):(t.__proto__=l,gt(t,r,"GeneratorFunction")),t.prototype=Object.create(d),t}return c.prototype=l,gt(d,"constructor",l),gt(l,"constructor",c),c.displayName="GeneratorFunction",gt(l,r,"GeneratorFunction"),gt(d),gt(d,r,"Generator"),gt(d,o,(function(){return this})),gt(d,"toString",(function(){return"[object Generator]"})),(yt=function(){return{w:a,m:p}})()}function gt(t,e,n,o){var r=Object.defineProperty;try{r({},"",{})}catch(t){r=0}(gt=function(t,e,n,o){function a(e,n){gt(t,e,(function(t){return this._invoke(e,n,t)}))}e?r?r(t,e,{value:n,enumerable:!o,configurable:!o,writable:!o}):t[e]=n:(a("next",0),a("throw",1),a("return",2))})(t,e,n,o)}function wt(t,e,n,o,r,a,s){try{var i=t[a](s),c=i.value}catch(t){return void n(t)}i.done?e(c):Promise.resolve(c).then(o,r)}function _t(t){return function(){var e=this,n=arguments;return new Promise((function(o,r){var a=t.apply(e,n);function s(t){wt(a,o,r,s,i,"next",t)}function i(t){wt(a,o,r,s,i,"throw",t)}s(void 0)}))}}function xt(){return(xt=_t(yt().m((function t(){return yt().w((function(t){for(;;)switch(t.n){case 0:return o.b.disableCSS(!0),window.title="AI Assistant Health Dashboard",widget.setTitle(window.title),console.log("[Main] Initializing Health Dashboard widget"),t.n=1,h();case 1:new r.a({store:ht,vuetify:mt,render:function(t){return t(vt)}}).$mount("app"),console.log("[Main] Health Dashboard mounted successfully"),requirejs(["DS/PlatformAPI/PlatformAPI"],(function(t){console.log("[Main] PlatformAPI loaded")}));case 2:return t.a(2)}}),t)})))).apply(this,arguments)}e.default=function(){widget.addEvent("onLoad",(function(){!function(){xt.apply(this,arguments)}()})),widget.addEvent("onRefresh",(function(){}))}},368:function(t,e,n){(e=n(317)(!1)).push([t.i,"\n.structure-tree[data-v-7db409ba] {\n  font-family: monospace;\n  font-size: 14px;\n}\n.tree-node[data-v-7db409ba] {\n  margin-bottom: 4px;\n}\n.node-header[data-v-7db409ba] {\n  display: flex;\n  align-items: center;\n  padding: 4px 0;\n}\n.node-icon[data-v-7db409ba] {\n  font-size: 16px;\n  line-height: 1;\n}\n.node-name[data-v-7db409ba] {\n  margin-left: 8px;\n  font-weight: 500;\n  font-size: 14px;\n}\n.node-quantity[data-v-7db409ba] {\n  margin-left: 8px;\n  padding: 2px 8px;\n  background-color: #e3f2fd;\n  border-radius: 12px;\n  font-size: 11px;\n  font-weight: 600;\n  color: #1976d2;\n}\n.node-children[data-v-7db409ba] {\n  margin-top: 4px;\n}\n.json-view[data-v-7db409ba] {\n  background-color: #f5f5f5;\n  padding: 16px;\n  border-radius: 4px;\n  overflow-x: auto;\n  font-family: 'Courier New', monospace;\n  font-size: 13px;\n  line-height: 1.5;\n}\n.gap-2[data-v-7db409ba] {\n  gap: 8px;\n}\n",""]),t.exports=e},439:function(t,e,n){(e=n(317)(!1)).push([t.i,"\n.v-application[data-v-4ae0ad98] {\n  background-color: #f5f5f5;\n}\n",""]),t.exports=e}}]);